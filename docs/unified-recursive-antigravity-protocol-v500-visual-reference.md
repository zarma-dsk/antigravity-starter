# Unified Recursive Antigravity Protocol

## ğŸŒŒ Unified Recursive Antigravity Protocol PROTOCOL 5.0.0
### VISUAL REFERENCE GUIDE
#### Flowcharts, Patterns, and Quick Lookups

---

### ğŸ“Š FLOWCHART 1: 10-STEP DECISION PROCESS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   START: Identify Issue/Refactoring    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 1. OBSERVE       â”‚ â† Read actual code
         â”‚ (What's broken?)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 2. QUESTION      â”‚ â† Why? Impact? Severity?
         â”‚ (5 questions)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 3. RESEARCH      â”‚ â† Check established sources
         â”‚ (NOT AI)         â”‚   OWASP, Framework docs,
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   Library documentation
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Found answers?  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         YES âœ…   â”‚   âŒ NO
                  â–¼
         Continue             â† Go back to 3. RESEARCH
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 4. HYPOTHESIZE   â”‚ â† Propose solution
         â”‚ (Using proven    â”‚   using established
         â”‚  patterns only)  â”‚   patterns
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 5. PREDICT       â”‚ â† Improvements? Risks?
         â”‚ (List both)      â”‚   Mitigations?
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 6. TEST          â”‚ â† Write tests
         â”‚ (Before coding)  â”‚   Unit + Security
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 7. ANALYZE       â”‚ â† Review results
         â”‚ (Review results) â”‚   New issues?
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 8. REFACTOR      â”‚ â† Clean up
         â”‚ (Based on tests) â”‚   Optimize
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 9. DOCUMENT      â”‚ â† Add security comments
         â”‚ (Decision logs)  â”‚   References
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ 10. VALIDATE     â”‚ â† npm audit
         â”‚ (4+ gates)       â”‚   npm build
         â”‚                  â”‚   npm type-check
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ All pass?       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         YES âœ…   â”‚   âŒ NO
                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       Go back to Step 8
    âœ…   â”‚ CODE IS READY    â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€(REFACTOR)
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ“Š FLOWCHART 2: 8-GATE FORTRESS PATTERN

```
                    USER INPUT
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GATE 1: INPUT VALIDATION      â”‚
        â”‚  - Check type (string, email)  â”‚
        â”‚  - Check range (0-100)         â”‚
        â”‚  - Check format (uuid, etc)    â”‚
        â”‚  Tool: Zod                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         âœ… Valid?   â”‚   âŒ Invalid
                     â”‚   â”œâ”€â†’ Return error
                     â”‚   â””â”€â†’ Log attempt
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GATE 2: AUTHENTICATION        â”‚
        â”‚  - Is user logged in?          â”‚
        â”‚  - Is session valid?           â”‚
        â”‚  - Is token not expired?       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         âœ… Auth OK? â”‚   âŒ Unauthorized
                     â”‚   â”œâ”€â†’ Return 401
                     â”‚   â””â”€â†’ Log attempt
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GATE 3: AUTHORIZATION         â”‚
        â”‚  - User owns this resource?    â”‚
        â”‚  - User has required role?     â”‚
        â”‚  - Feature enabled for user?   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         âœ… Allowed? â”‚   âŒ Forbidden
                     â”‚   â”œâ”€â†’ Return 403
                     â”‚   â””â”€â†’ Log attempt
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GATE 4: RATE LIMITING         â”‚
        â”‚  - Too many requests?          â”‚
        â”‚  - Suspicious pattern?         â”‚
        â”‚  - DDoS detection?             â”‚
        â”‚  Tool: Upstash/Redis           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         âœ… OK?      â”‚   âŒ Rate Limited
                     â”‚   â”œâ”€â†’ Return 429
                     â”‚   â””â”€â†’ Log attempt
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GATE 5-6: QUERY EXECUTION     â”‚
        â”‚  - Use Prisma ORM              â”‚
        â”‚  - No string interpolation     â”‚
        â”‚  - Prepared statements only    â”‚
        â”‚  - Respect foreign keys        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
         âœ… Success? â”‚   âŒ Error
                     â”‚   â”œâ”€â†’ Return error
                     â”‚   â””â”€â†’ Rollback transaction
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GATE 7: OUTPUT SANITIZATION   â”‚
        â”‚  - Map to DTO                  â”‚
        â”‚  - Remove sensitive fields     â”‚
        â”‚  - NO: passwordHash, apiKeys   â”‚
        â”‚  - YES: id, name, email        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GATE 8: AUDIT LOGGING         â”‚
        â”‚  - Log action                  â”‚
        â”‚  - Log actor (user ID)         â”‚
        â”‚  - Log result (success/fail)   â”‚
        â”‚  - Log timestamp               â”‚
        â”‚  Tool: Database audit_log      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
             RESPONSE TO CLIENT
              (Sanitized + Logged)
```

---

### ğŸ“Š FLOWCHART 3: SIMULTANEOUS TWO-TRACK EXECUTION

```
DAY 1: IDENTIFICATION
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Identify legacy code        â”‚ Identify vulnerabilities     â”‚
â”‚ Plan refactoring            â”‚ Plan security fixes          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                              â”‚
          â–¼                              â–¼
    TRACK A:                         TRACK B:
    Architecture                     Security
    Refactoring                      Hardening
    (PARALLEL)                       (PARALLEL)

DAY 1-2: PARALLEL EXECUTION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  Track A:                          Track B:                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  â”œâ”€ Extract components             â”œâ”€ Add Zod schemas      â”‚
â”‚  â”œâ”€ Move to _components/           â”œâ”€ Add validation       â”‚
â”‚  â”œâ”€ Extract logic to _actions      â”œâ”€ Add rate limiting    â”‚
â”‚  â”œâ”€ Move util to _lib/             â”œâ”€ Add DTO mapping      â”‚
â”‚  â”œâ”€ Add TypeScript types           â”œâ”€ Add audit logging    â”‚
â”‚  â””â”€ npm run type-check âœ…          â””â”€ npm audit --fix âœ…   â”‚
â”‚                                                              â”‚
â”‚  (Both tracks running simultaneously)                        â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                              â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
            DAY 2-3: INTEGRATION POINT
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Merge Track A + Track B  â”‚
            â”‚ in test environment      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
            DAY 3: FINAL TESTING
            â”œâ”€ npm run type-check âœ…
            â”œâ”€ npm run lint âœ…
            â”œâ”€ npm run test âœ…
            â”œâ”€ npm run build âœ…
            â”œâ”€ npm audit âœ…
            â””â”€ All gates pass âœ…
                         â”‚
                         â–¼
            âœ… READY FOR CODE REVIEW
               (Not deployment yet)

RESULT: 2-3 days instead of 4+ weeks
```

---

### ğŸ“Š FLOWCHART 4: DEPENDENCY VALIDATION

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  New package needed (npm install)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ STEP 1: Does package exist?  â”‚
    â”‚ $ npm view <package-name>    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    âœ… Found?  â”‚  âŒ Not found
               â”‚  â””â”€â†’ Hallucination!
               â”‚     Do not use
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ STEP 2: Check authenticity   â”‚
    â”‚ - Author verified?           â”‚
    â”‚ - GitHub present?            â”‚
    â”‚ - Recent maintenance?        â”‚
    â”‚ - Public repo with CI/CD?    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    âœ… OK?     â”‚  âŒ Suspicious
               â”‚  â””â”€â†’ Research further
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ STEP 3: Check adoption       â”‚
    â”‚ - Weekly downloads > 1000?   â”‚
    â”‚ - npm trends upward?         â”‚
    â”‚ - No recent security issues? â”‚
    â”‚ - Active issue resolution?   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    âœ… OK?     â”‚  âŒ Low adoption
               â”‚  â””â”€â†’ Verify necessity
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ STEP 4: Security check       â”‚
    â”‚ $ npm audit view <package>   â”‚
    â”‚ - Known vulnerabilities?     â”‚
    â”‚ - CVE history?               â”‚
    â”‚ - Author trustworthiness?    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    âœ… Safe?   â”‚  âŒ Vulnerable
               â”‚  â””â”€â†’ Find alternative
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ STEP 5: Add to vetted list   â”‚
    â”‚ - Add to vetted-libs.json    â”‚
    â”‚ - Record decision            â”‚
    â”‚ - Set approval date          â”‚
    â”‚ - Plan review date (6 mo)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    âœ… APPROVED TO USE
       (Add to package.json)
```

---

### ğŸ“Š FLOWCHART 5: CODE REVIEW CHECKLIST

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Code Review Gate               â”‚
â”‚  (Before: npm run build)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1. Check 10-Step Method    â”‚
    â”‚ âœ“ Observed actual code?    â”‚
    â”‚ âœ“ Questioned thoroughly?   â”‚
    â”‚ âœ“ Researched patterns?     â”‚
    â”‚ âœ“ Hypothesized solution?   â”‚
    â”‚ âœ“ Predicted risks?         â”‚
    â”‚ âœ“ Tested locally?          â”‚
    â”‚ âœ“ Analyzed results?        â”‚
    â”‚ âœ“ Refactored clean?        â”‚
    â”‚ âœ“ Documented decision?     â”‚
    â”‚ âœ“ Validated gates?         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    All pass?    â”‚
    YES âœ…  â”‚  NO âŒ
            â”‚  â””â”€â†’ Send back for changes
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 2. Check 5 Logics          â”‚
    â”‚ âœ“ Folder Logic OK?         â”‚
    â”‚ âœ“ Layer Logic OK?          â”‚
    â”‚ âœ“ Core Logic OK?           â”‚
    â”‚ âœ“ Code Logic OK?           â”‚
    â”‚ âœ“ Conceptual OK?           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    All pass?    â”‚
    YES âœ…  â”‚  NO âŒ
            â”‚  â””â”€â†’ Send back
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 3. Check 5 Security Logics â”‚
    â”‚ âœ“ Dependencies verified?   â”‚
    â”‚ âœ“ Inputs validated (Zod)?  â”‚
    â”‚ âœ“ Outputs sanitized (DTO)? â”‚
    â”‚ âœ“ No dynamic imports?      â”‚
    â”‚ âœ“ Data flow unidirectional?â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    All pass?    â”‚
    YES âœ…  â”‚  NO âŒ
            â”‚  â””â”€â†’ Send back
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 4. Check 8-Gate Fortress   â”‚
    â”‚ âœ“ Input validation?        â”‚
    â”‚ âœ“ Authentication?          â”‚
    â”‚ âœ“ Authorization?           â”‚
    â”‚ âœ“ Rate limiting?           â”‚
    â”‚ âœ“ Query execution?         â”‚
    â”‚ âœ“ Sanitation?              â”‚
    â”‚ âœ“ Logging?                 â”‚
    â”‚ âœ“ Error handling?          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    All pass?    â”‚
    YES âœ…  â”‚  NO âŒ
            â”‚  â””â”€â†’ Send back
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 5. Check Documentation     â”‚
    â”‚ âœ“ Security comments added? â”‚
    â”‚ âœ“ Decision log present?    â”‚
    â”‚ âœ“ References cited?        â”‚
    â”‚ âœ“ Tests documented?        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    All pass?    â”‚
    YES âœ…  â”‚  NO âŒ
            â”‚  â””â”€â†’ Send back
            â”‚
            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 6. Run Validation Suite    â”‚
    â”‚ $ npm run type-check       â”‚
    â”‚ $ npm run lint             â”‚
    â”‚ $ npm run test             â”‚
    â”‚ $ npm run build            â”‚
    â”‚ $ npm audit                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    All pass?    â”‚
    YES âœ…  â”‚  NO âŒ
            â”‚  â””â”€â†’ Fix and retry
            â”‚
            â–¼
    âœ… APPROVED FOR MERGE
```

---

### ğŸ“‹ QUICK REFERENCE TABLE 1: 10-Step Deliverables

| Step | Activity | Deliverable | Duration |
|------|----------|-------------|----------|
| 1 | OBSERVE | Line-by-line code review | 15 min |
| 2 | QUESTION | Written answers (5 Q's) | 10 min |
| 3 | RESEARCH | 3+ established sources + notes | 20 min |
| 4 | HYPOTHESIZE | Proposed solution + reasoning | 15 min |
| 5 | PREDICT | Lists of improvements + risks | 10 min |
| 6 | TEST | 5+ test cases + results | 30 min |
| 7 | ANALYZE | Test result analysis | 10 min |
| 8 | REFACTOR | Clean code + optimization | 30 min |
| 9 | DOCUMENT | Security decision log | 15 min |
| 10 | VALIDATE | npm audit + npm build âœ… | 5 min |
| **TOTAL** | | **Ready for Production** | **2.5 hours** |

---

### ğŸ“‹ QUICK REFERENCE TABLE 2: Gate Requirements

| Gate | Check | Pass Criteria | Tool |
|------|-------|---------------|------|
| 1 | Input Validation | All fields validated with Zod | npm run build |
| 2 | Authentication | Session verified | npm run type-check |
| 3 | Authorization | Permissions checked | Code review |
| 4 | Rate Limiting | Limits enforced | npm run test |
| 5-6 | Query Execution | Prisma ORM (no raw SQL) | npm run lint |
| 7 | Output Sanitization | DTO mapping only | Code review |
| 8 | Audit Logging | All actions logged | npm audit |

**Rule:** All 8 gates must pass for production code.

---

### ğŸ“‹ QUICK REFERENCE TABLE 3: Anti-Patterns (âŒ Don't Do)

| Pattern | Problem | Solution |
|---------|---------|----------|
| âŒ `const data = any` | No type safety | âœ… `const data: UserDTO` |
| âŒ Raw SQL strings | SQL injection | âœ… Prisma ORM |
| âŒ `return user` object | Password leak | âœ… `return sanitizeUser(user)` |
| âŒ `eval()` | Code injection | âœ… Static imports only |
| âŒ Skip input validation | Invalid data | âœ… Always use Zod |
| âŒ No error handling | Silent failures | âœ… Try/catch + return errors |
| âŒ No logging | No audit trail | âœ… Log all actions |
| âŒ AI-generated code (untested) | Hallucinations | âœ… Follow 10-step method |
| âŒ Trust npm audit only | Miss vulnerabilities | âœ… Manual verification too |
| âŒ Skip build verification | Runtime failures | âœ… Always `npm run build` |

---

### ğŸ¯ DECISION TREE: Do I Need to Refactor This?

```
Is this legacy code? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚
YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ Does it work well?  â”‚
NO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”œâ”€â–ºYES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                       â”‚ SKIP   â”‚
                              â”‚ NO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                     â”‚ NEED   â”‚
    Is it security-critical? â”€â–ºREFACTOR (5.0.0)    â”‚
    YES                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    NO â”€â”€â”€â”€â–º Skip for now
```

---

### âœ¨ VISUAL SUMMARY

```
                    ğŸŒŒ Unified Recursive Antigravity Protocol 5.0.0 ğŸŒŒ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  10-STEP SCIENTIFIC METHOD              â”‚
â”‚  OBSERVE â†’ QUESTION â†’ RESEARCH â†’ HYPOTHESIZE â†’ PREDICT â”‚
â”‚              â†’ TEST â†’ ANALYZE â†’ REFACTOR â†’ DOCUMENT    â”‚
â”‚                     â†’ VALIDATE                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ 8-GATE FORTRESS â”‚
                   â”‚   PATTERN       â”‚
                   â”‚ 1. Validate     â”‚
                   â”‚ 2. Authenticate â”‚
                   â”‚ 3. Authorize    â”‚
                   â”‚ 4. Rate Limit   â”‚
                   â”‚ 5-6. Execute    â”‚
                   â”‚ 7. Sanitize     â”‚
                   â”‚ 8. Log          â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  5 ARCHITECTURE + 5 SECURITY   â”‚
           â”‚  LOGICS ENFORCED               â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  SIMULTANEOUS TWO-TRACK MODEL  â”‚
           â”‚  Track A: Refactoring          â”‚
           â”‚  Track B: Security (Parallel)  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                  âœ… PRODUCTION READY
                 ğŸ›¡ï¸ SECURITY HARDENED
                ğŸš€ DEPLOYMENT PREPARED
```

---

**Status: âœ… Unified Recursive Antigravity Protocol 5.0.0 VISUAL REFERENCE COMPLETE**
**Use these flowcharts for quick decision-making and team communication.**
